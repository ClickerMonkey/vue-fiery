{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///vue-fiery.js","webpack:///webpack/bootstrap 824a3f9ecb0408d755a6","webpack:///./src/index.ts","webpack:///./src/plugin.ts","webpack:///./src/mixin.ts","webpack:///./src/util.ts","webpack:///./src/constants.ts","webpack:///./src/entry.ts","webpack:///./src/options.ts","webpack:///./src/operations.ts","webpack:///./src/documents.ts","webpack:///./src/factory/index.ts","webpack:///./src/factory/document.ts","webpack:///./src/factory/map.ts","webpack:///./src/factory/collection.ts"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","Object","defineProperty","value","plugin_1","default","install","Vue","mixin","beforeCreate","mixin_1","init","created","link","beforeDestroy","destroy","window","use","_this","$fiery","factory_1","factoryInstance","stores","storeKeyNext","storeIdToKey","options","optionKeyNext","entry","entryList","update","operations","bind","sync","remove","clear","getChanges","ref","getMetadata","data","util_1","$fires","forEach","entry_1","closeEntry","i","length","parent","property","prop","target","source","isObject","x","prototype","toString","isFunction","isArray","Array","isCollectionSource","iterable","callback","vm","uid","constants_1","PROP_UID","_a","split","UID_SEPARATOR","storeKey","optionKey","path","store","parseInt","createRecord","record","recordOptions","recordFunctions","isEqual","a","b","PROP_VALUE","ENTRY_SEPARATOR","STORE_SEPARATOR","RECORD_OPTIONS","off","getEntry","optionsInput","entryKeyInput","useRawOptions","options_1","getOptions","newCollection","newDocument","entryKey","fiery","fires","existing","children","index","push","onError","message","onMissing","onSuccess","results","onRemove","liveOptions","propValue","fields","excludeSubs","sub","props","fieldsOrCallback","callbackOrEquality","equalityOrNothing","type","typeConstructor_1","encoded","map","exclude","excludeArray","key","excludeMap","recordOperation","subProp","subOptions","values","getValues","doc","set","delete","propsArray","deleting","deleteCount","_i","propsArray_1","firebaseRuntime","app","firebase_","firestore","FieldValue","undefined","equality","current_1","get","then","documents_1","parseDocument","updated","old","changes","valueUpdated","valueOld","collection","explicit","include","encoders","decodeDocument","decode","decoders","out","refreshDocument","replace","reset","decoded","replaced","copyData","identifier","getDocumentIdentifier","subEntryKey","subEntry","$set","destroyDocuments","fromObject","destroyDocument","$delete","getStoreKey","_firestore","db","_databaseId","database","projectId","chosenFactory","where","map_1","collection_1","document_1","once","promise","onceOptions","handleDocumentUpdate","catch","onSnapshot","exists","query","querySnapshot","missing","docChanges","change","splice","newIndex","oldIndex"],"mappings":"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","file":"vue-fiery.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"VueFiery\"] = factory();\n\telse\n\t\troot[\"VueFiery\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"VueFiery\"] = factory();\n\telse\n\t\troot[\"VueFiery\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar plugin_1 = __webpack_require__(1);\n\texports.default = plugin_1.default;\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar mixin_1 = __webpack_require__(2);\n\tfunction install(Vue) {\n\t    Vue.mixin({\n\t        beforeCreate: mixin_1.init,\n\t        created: mixin_1.link,\n\t        beforeDestroy: mixin_1.destroy\n\t    });\n\t}\n\texports.install = install;\n\tif (typeof window !== 'undefined' && window.Vue) {\n\t    window.Vue.use(install);\n\t}\n\texports.default = install;\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar util_1 = __webpack_require__(3);\n\tvar entry_1 = __webpack_require__(5);\n\tvar operations = __webpack_require__(7);\n\tvar factory_1 = __webpack_require__(9);\n\tfunction init() {\n\t    var _this = this;\n\t    this.$fiery = factory_1.factoryInstance(this);\n\t    this.$fiery.stores = {};\n\t    this.$fiery.storeKeyNext = 0;\n\t    this.$fiery.storeIdToKey = {};\n\t    this.$fiery.options = {};\n\t    this.$fiery.optionKeyNext = 0;\n\t    this.$fiery.entry = {};\n\t    this.$fiery.entryList = [];\n\t    this.$fiery.update = operations.update.bind(this);\n\t    this.$fiery.sync = operations.sync.bind(this);\n\t    this.$fiery.remove = operations.remove.bind(this);\n\t    this.$fiery.clear = operations.clear.bind(this);\n\t    this.$fiery.getChanges = operations.getChanges.bind(this);\n\t    this.$fiery.ref = operations.ref.bind(this);\n\t    this.$fiery.link = link.bind(this);\n\t    this.$fiery.destroy = destroy.bind(this);\n\t    this.$fiery.getMetadata = function (data) { return util_1.getMetadata(_this, data); };\n\t    this.$fires = {};\n\t}\n\texports.init = init;\n\tfunction destroy() {\n\t    this.$fiery.stores = {};\n\t    this.$fiery.entry = {};\n\t    this.$fiery.entryList.forEach(entry_1.closeEntry);\n\t    this.$fiery.entryList = [];\n\t    this.$fiery = (function () { });\n\t    this.$fires = {};\n\t}\n\texports.destroy = destroy;\n\tfunction link() {\n\t    var entryList = this.$fiery.entryList;\n\t    for (var i = 0; i < entryList.length; i++) {\n\t        var entry = entryList[i];\n\t        if (entry === null) {\n\t            continue;\n\t        }\n\t        var options = entry.options;\n\t        if (!options.parent && !options.property) {\n\t            for (var prop in this) {\n\t                if (this[prop] === entry.target) {\n\t                    options.property = prop;\n\t                    this.$fiery.entry[prop] = entry;\n\t                    this.$fires[prop] = entry.source;\n\t                    break;\n\t                }\n\t            }\n\t        }\n\t    }\n\t}\n\texports.link = link;\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar constants_1 = __webpack_require__(4);\n\tfunction isObject(x) {\n\t    return Object.prototype.toString.call(x) === '[object Object]';\n\t}\n\texports.isObject = isObject;\n\tfunction isFunction(x) {\n\t    return typeof x === 'function';\n\t}\n\texports.isFunction = isFunction;\n\tfunction isArray(x) {\n\t    return x && x instanceof Array;\n\t}\n\texports.isArray = isArray;\n\tfunction isCollectionSource(source) {\n\t    return !!(source.where);\n\t}\n\texports.isCollectionSource = isCollectionSource;\n\tfunction forEach(iterable, callback) {\n\t    if (isArray(iterable)) {\n\t        for (var i = 0; i < iterable.length; i++) {\n\t            callback(iterable[i], i, iterable);\n\t        }\n\t        return true;\n\t    }\n\t    else if (isObject(iterable)) {\n\t        for (var prop in iterable) {\n\t            callback(iterable[prop], prop, iterable);\n\t        }\n\t        return true;\n\t    }\n\t    return false;\n\t}\n\texports.forEach = forEach;\n\tfunction getMetadata(vm, data) {\n\t    var uid = data[constants_1.PROP_UID];\n\t    var _a = uid.split(constants_1.UID_SEPARATOR), storeKey = _a[0], optionKey = _a[1], path = _a[2];\n\t    var store = vm.$fiery.stores[parseInt(storeKey)];\n\t    var options = vm.$fiery.options[parseInt(optionKey)];\n\t    return { uid: uid, path: path, storeKey: storeKey, store: store, optionKey: optionKey, options: options };\n\t}\n\texports.getMetadata = getMetadata;\n\tfunction createRecord(data, options) {\n\t    if (options.record) {\n\t        var recordOptions = options.recordOptions;\n\t        var recordFunctions = options.recordFunctions;\n\t        if (recordOptions.sync)\n\t            data[recordOptions.sync] = recordFunctions.sync;\n\t        if (recordOptions.update)\n\t            data[recordOptions.update] = recordFunctions.update;\n\t        if (recordOptions.remove)\n\t            data[recordOptions.remove] = recordFunctions.remove;\n\t        if (recordOptions.clear)\n\t            data[recordOptions.clear] = recordFunctions.clear;\n\t        if (recordOptions.getChanges)\n\t            data[recordOptions.getChanges] = recordFunctions.getChanges;\n\t        if (recordOptions.ref)\n\t            data[recordOptions.ref] = recordFunctions.ref;\n\t    }\n\t    return data;\n\t}\n\texports.createRecord = createRecord;\n\tfunction isEqual(a, b) {\n\t    if (a === b) {\n\t        return true;\n\t    }\n\t    if (!a || !b) {\n\t        return false;\n\t    }\n\t    if (isArray(a) && isArray(b)) {\n\t        if (a.length !== b.length) {\n\t            return false;\n\t        }\n\t        for (var i = 0; i < a.length; i++) {\n\t            if (!isEqual(a[i], b[i])) {\n\t                return false;\n\t            }\n\t        }\n\t        return true;\n\t    }\n\t    if (isObject(a) && isObject(b)) {\n\t        for (var prop in a) {\n\t            if (!isEqual(a[prop], b[prop])) {\n\t                return false;\n\t            }\n\t        }\n\t        for (var prop in b) {\n\t            if (!(prop in a)) {\n\t                return false;\n\t            }\n\t        }\n\t        return true;\n\t    }\n\t    return false;\n\t}\n\texports.isEqual = isEqual;\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\texports.PROP_VALUE = '.value';\n\texports.PROP_UID = '.uid';\n\texports.UID_SEPARATOR = '///';\n\texports.ENTRY_SEPARATOR = '/';\n\texports.STORE_SEPARATOR = '/';\n\texports.RECORD_OPTIONS = {\n\t    sync: '$sync',\n\t    update: '$update',\n\t    remove: '$remove',\n\t    ref: '$ref',\n\t    clear: '$clear',\n\t    getChanges: '$getChanges'\n\t};\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar util_1 = __webpack_require__(3);\n\tvar options_1 = __webpack_require__(6);\n\tfunction closeEntry(entry) {\n\t    if (entry && entry.off) {\n\t        entry.off();\n\t        delete entry.off;\n\t    }\n\t}\n\texports.closeEntry = closeEntry;\n\tfunction getEntry(vm, source, optionsInput, entryKeyInput, useRawOptions) {\n\t    if (useRawOptions === void 0) { useRawOptions = false; }\n\t    var options = useRawOptions\n\t        ? optionsInput\n\t        : options_1.getOptions(vm, optionsInput, source);\n\t    var target = util_1.isCollectionSource(source)\n\t        ? options.newCollection()\n\t        : options.newDocument();\n\t    var property = options.property;\n\t    var entryKey = entryKeyInput || property || '';\n\t    var fiery = vm.$fiery;\n\t    var fires = vm.$fires;\n\t    var existing = fiery.entry[entryKey];\n\t    var children = {};\n\t    var entry = { source: source, options: options, target: target, children: children };\n\t    if (existing) {\n\t        closeEntry(existing);\n\t        entry.target = existing.target;\n\t    }\n\t    if (!entryKey || !(entryKey in fiery.entry)) {\n\t        entry.index = fiery.entryList.length;\n\t        fiery.entryList.push(entry);\n\t    }\n\t    if (entryKey) {\n\t        fiery.entry[entryKey] = entry;\n\t    }\n\t    if (property) {\n\t        fires[property] = source;\n\t    }\n\t    return entry;\n\t}\n\texports.getEntry = getEntry;\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar constants_1 = __webpack_require__(4);\n\tvar util_1 = __webpack_require__(3);\n\tvar operations = __webpack_require__(7);\n\tfunction getOptions(vm, options, source) {\n\t    if (!options || !util_1.isObject(options)) {\n\t        options = {};\n\t    }\n\t    if (!util_1.isFunction(options.onError)) {\n\t        options.onError = function (message) { };\n\t    }\n\t    if (!util_1.isFunction(options.onMissing)) {\n\t        options.onMissing = function () { };\n\t    }\n\t    if (!util_1.isFunction(options.onSuccess)) {\n\t        options.onSuccess = function (results) { };\n\t    }\n\t    if (!util_1.isFunction(options.onRemove)) {\n\t        options.onRemove = function () { };\n\t    }\n\t    if (!options.liveOptions) {\n\t        options.liveOptions = {};\n\t    }\n\t    if (!options.propValue) {\n\t        options.propValue = constants_1.PROP_VALUE;\n\t    }\n\t    if (!options.recordOptions) {\n\t        options.recordOptions = constants_1.RECORD_OPTIONS;\n\t    }\n\t    if (options.record) {\n\t        options.recordFunctions = {\n\t            sync: function (fields) {\n\t                return operations.sync.call(vm, this, fields);\n\t            },\n\t            update: function (fields) {\n\t                return operations.update.call(vm, this, fields);\n\t            },\n\t            remove: function (excludeSubs) {\n\t                if (excludeSubs === void 0) { excludeSubs = false; }\n\t                return operations.remove.call(vm, this, excludeSubs);\n\t            },\n\t            ref: function (sub) {\n\t                return operations.ref.call(vm, this, sub);\n\t            },\n\t            clear: function (props) {\n\t                return operations.clear.call(vm, this, props);\n\t            },\n\t            getChanges: function (fieldsOrCallback, callbackOrEquality, equalityOrNothing) {\n\t                return operations.getChanges.call(vm, this, fieldsOrCallback, callbackOrEquality, equalityOrNothing);\n\t            }\n\t        };\n\t    }\n\t    if (options.type) {\n\t        var typeConstructor_1 = options.type;\n\t        options.newDocument = function (encoded) { return new typeConstructor_1(); };\n\t    }\n\t    else if (!options.newDocument) {\n\t        options.newDocument = function (encoded) { return ({}); };\n\t    }\n\t    if (!options.newCollection) {\n\t        options.newCollection = options.map\n\t            ? function () { return ({}); }\n\t            : function () { return []; };\n\t    }\n\t    if (!options.exclude) {\n\t        options.exclude = {};\n\t        if (options.key) {\n\t            options.exclude[options.key] = true;\n\t        }\n\t    }\n\t    else if (util_1.isArray(options.exclude)) {\n\t        var excludeArray = options.exclude;\n\t        options.exclude = {};\n\t        for (var i = 0; i < excludeArray.length; i++) {\n\t            options.exclude[excludeArray[i]] = true;\n\t        }\n\t    }\n\t    var excludeMap = options.exclude;\n\t    excludeMap[options.propValue] = true;\n\t    excludeMap[constants_1.PROP_UID] = true;\n\t    for (var recordOperation in options.recordOptions) {\n\t        excludeMap[options.recordOptions[recordOperation]] = true;\n\t    }\n\t    if (options.sub) {\n\t        for (var subProp in options.sub) {\n\t            var subOptions = getOptions(vm, options.sub[subProp]);\n\t            subOptions.property = subProp;\n\t            subOptions.parent = options;\n\t            options.sub[subProp] = subOptions;\n\t            excludeMap[subProp] = true;\n\t        }\n\t    }\n\t    if (!options.id) {\n\t        var fiery = vm.$fiery;\n\t        options.id = ++fiery.optionKeyNext;\n\t        fiery.options[options.id] = options;\n\t    }\n\t    return options;\n\t}\n\texports.getOptions = getOptions;\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar documents_1 = __webpack_require__(8);\n\tvar util_1 = __webpack_require__(3);\n\tfunction update(data, fields) {\n\t    var _a = util_1.getMetadata(this, data), store = _a.store, path = _a.path, options = _a.options;\n\t    if (store && path) {\n\t        var values = getValues(data, options, fields);\n\t        return store.doc(path).update(values);\n\t    }\n\t}\n\texports.update = update;\n\tfunction sync(data, fields) {\n\t    var _a = util_1.getMetadata(this, data), store = _a.store, path = _a.path, options = _a.options;\n\t    if (store && path) {\n\t        var values = getValues(data, options, fields);\n\t        return store.doc(path).set(values);\n\t    }\n\t}\n\texports.sync = sync;\n\tfunction remove(data, excludeSubs) {\n\t    var _this = this;\n\t    if (excludeSubs === void 0) { excludeSubs = false; }\n\t    var _a = util_1.getMetadata(this, data), store = _a.store, path = _a.path, options = _a.options;\n\t    if (store && path) {\n\t        if (!excludeSubs && options.sub) {\n\t            for (var subProp in options.sub) {\n\t                util_1.forEach(data[subProp], function (sub) {\n\t                    _this.remove(sub);\n\t                });\n\t            }\n\t        }\n\t        return store.doc(path).delete();\n\t    }\n\t}\n\texports.remove = remove;\n\tfunction clear(data, props) {\n\t    var _this = this;\n\t    var _a = util_1.getMetadata(this, data), store = _a.store, path = _a.path, options = _a.options;\n\t    var propsArray = props instanceof Array ? props : [props];\n\t    if (store && path) {\n\t        var doc = store.doc(path);\n\t        var deleting = {};\n\t        var deleteCount = 0;\n\t        for (var _i = 0, propsArray_1 = propsArray; _i < propsArray_1.length; _i++) {\n\t            var prop = propsArray_1[_i];\n\t            if (options.sub && prop in options.sub && data[prop]) {\n\t                util_1.forEach(data[prop], function (sub) {\n\t                    _this.remove(sub);\n\t                });\n\t            }\n\t            else if (prop in data) {\n\t                var firebaseRuntime = store.app.firebase_;\n\t                if (firebaseRuntime) {\n\t                    deleting[prop] = firebaseRuntime.firestore.FieldValue.delete();\n\t                    deleteCount++;\n\t                }\n\t            }\n\t        }\n\t        if (deleteCount > 0) {\n\t            return doc.update(deleting);\n\t        }\n\t    }\n\t}\n\texports.clear = clear;\n\tfunction getChanges(data, fieldsOrCallback, callbackOrEquality, equalityOrNothing) {\n\t    var _a = util_1.getMetadata(this, data), store = _a.store, path = _a.path, options = _a.options;\n\t    var fields = typeof fieldsOrCallback === 'string' ? fieldsOrCallback : undefined;\n\t    var callback = (fields ? callbackOrEquality : fieldsOrCallback);\n\t    var equality = ((fields ? equalityOrNothing : callbackOrEquality) || util_1.isEqual);\n\t    if (store && path) {\n\t        var current_1 = getValues(data, options, fields);\n\t        return store.doc(path).get().then(function (doc) {\n\t            var encoded = documents_1.parseDocument(doc, options);\n\t            var updated = {};\n\t            var old = {};\n\t            var changes = false;\n\t            for (var prop in current_1) {\n\t                var valueUpdated = encoded[prop];\n\t                var valueOld = current_1[prop];\n\t                if (!equality(valueOld, valueUpdated)) {\n\t                    changes = true;\n\t                    updated[prop] = valueUpdated;\n\t                    old[prop] = valueOld;\n\t                }\n\t            }\n\t            callback(changes, updated, old);\n\t        });\n\t    }\n\t}\n\texports.getChanges = getChanges;\n\tfunction ref(data, sub) {\n\t    var _a = util_1.getMetadata(this, data), store = _a.store, path = _a.path;\n\t    if (store && path) {\n\t        var doc = store.doc(path);\n\t        return sub ? doc.collection(sub) : doc;\n\t    }\n\t}\n\texports.ref = ref;\n\tfunction getValues(data, options, fields) {\n\t    var explicit = fields || options.include;\n\t    var values = {};\n\t    if (explicit) {\n\t        for (var i = 0; i < explicit.length; i++) {\n\t            var prop = explicit[i];\n\t            if (prop in data) {\n\t                values[prop] = data[prop];\n\t            }\n\t        }\n\t    }\n\t    else {\n\t        for (var prop in data) {\n\t            if (!(prop in options.exclude)) {\n\t                values[prop] = data[prop];\n\t            }\n\t        }\n\t    }\n\t    if (options.encoders) {\n\t        for (var prop in options.encoders) {\n\t            if (prop in values) {\n\t                values[prop] = options.encoders[prop](values[prop], data);\n\t            }\n\t        }\n\t    }\n\t    return values;\n\t}\n\texports.getValues = getValues;\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar constants_1 = __webpack_require__(4);\n\tvar util_1 = __webpack_require__(3);\n\tvar entry_1 = __webpack_require__(5);\n\tvar factory_1 = __webpack_require__(9);\n\tfunction decodeDocument(encoded, options) {\n\t    if (options.decode) {\n\t        encoded = options.decode(encoded);\n\t    }\n\t    else if (options.decoders) {\n\t        for (var prop in options.decoders) {\n\t            if (prop in encoded) {\n\t                encoded[prop] = options.decoders[prop](encoded[prop], encoded);\n\t            }\n\t        }\n\t    }\n\t    return encoded;\n\t}\n\texports.decodeDocument = decodeDocument;\n\tfunction parseDocument(doc, options) {\n\t    var _a;\n\t    var value = doc.data();\n\t    var out = (util_1.isObject(value) ? value : (_a = {}, _a[options.propValue] = value, _a));\n\t    if (out && options.key) {\n\t        out[options.key] = doc.id;\n\t    }\n\t    return out;\n\t}\n\texports.parseDocument = parseDocument;\n\tfunction refreshDocument(vm, entry, doc, data) {\n\t    var options = entry.options;\n\t    var property = options.property;\n\t    var replace = !!(options.reset && property);\n\t    var encoded = parseDocument(doc, options);\n\t    var decoded = decodeDocument(encoded, options);\n\t    if (!data) {\n\t        var identifier = getDocumentIdentifier(vm, options, doc);\n\t        data = options.newDocument(decoded);\n\t        data[constants_1.PROP_UID] = identifier;\n\t        copyData(vm, data, decoded);\n\t        util_1.createRecord(data, options);\n\t        if (options.sub) {\n\t            for (var subProp in options.sub) {\n\t                var subOptions = options.sub[subProp];\n\t                var subEntryKey = doc.ref.path + constants_1.ENTRY_SEPARATOR + subProp;\n\t                var subEntry = entry_1.getEntry(vm, doc.ref.collection(subProp), subOptions, subEntryKey, true);\n\t                data[subProp] = factory_1.factory(vm, subEntry);\n\t            }\n\t        }\n\t    }\n\t    else if (replace) {\n\t        var replaced = options.newDocument(decoded);\n\t        if (options.sub) {\n\t            for (var subProp in options.sub) {\n\t                if (data[subProp]) {\n\t                    replaced[subProp] = data[subProp];\n\t                }\n\t            }\n\t        }\n\t        util_1.createRecord(replaced, options);\n\t        data = copyData(vm, replaced, decoded);\n\t    }\n\t    else {\n\t        copyData(vm, data, decoded);\n\t    }\n\t    return data;\n\t}\n\texports.refreshDocument = refreshDocument;\n\tfunction copyData(vm, data, update) {\n\t    for (var prop in update) {\n\t        vm.$set(data, prop, update[prop]);\n\t    }\n\t    return data;\n\t}\n\texports.copyData = copyData;\n\tfunction destroyDocuments(vm, map, fromObject) {\n\t    for (var id in map) {\n\t        var old = map[id];\n\t        destroyDocument(vm, old);\n\t        if (fromObject) {\n\t            vm.$delete(fromObject, id);\n\t        }\n\t    }\n\t}\n\texports.destroyDocuments = destroyDocuments;\n\tfunction destroyDocument(vm, data) {\n\t    var _a = util_1.getMetadata(vm, data), path = _a.path, options = _a.options;\n\t    if (options.sub) {\n\t        var fiery = vm.$fiery;\n\t        for (var subProp in options.sub) {\n\t            var subEntryKey = path + constants_1.ENTRY_SEPARATOR + subProp;\n\t            var subEntry = fiery.entry[subEntryKey];\n\t            if (subEntry) {\n\t                entry_1.closeEntry(subEntry);\n\t                delete fiery.entry[subEntryKey];\n\t                if (typeof subEntry.index === 'number') {\n\t                    fiery.entryList[subEntry.index] = null;\n\t                    delete subEntry.index;\n\t                }\n\t            }\n\t            util_1.forEach(data[subProp], function (value) {\n\t                destroyDocument(vm, value);\n\t            });\n\t        }\n\t    }\n\t}\n\texports.destroyDocument = destroyDocument;\n\tfunction getDocumentIdentifier(vm, options, doc) {\n\t    return getStoreKey(vm, doc) +\n\t        constants_1.UID_SEPARATOR +\n\t        options.id +\n\t        constants_1.UID_SEPARATOR +\n\t        doc.ref.path;\n\t}\n\texports.getDocumentIdentifier = getDocumentIdentifier;\n\tfunction getStoreKey(vm, doc) {\n\t    var firestore = doc._firestore;\n\t    var db = firestore._databaseId;\n\t    var id = db.database + constants_1.STORE_SEPARATOR + db.projectId;\n\t    var fiery = vm.$fiery;\n\t    var key = fiery.storeIdToKey[id];\n\t    if (!key) {\n\t        key = ++fiery.storeKeyNext;\n\t        fiery.stores[key] = firestore;\n\t        fiery.storeIdToKey[id] = key;\n\t    }\n\t    return key;\n\t}\n\texports.getStoreKey = getStoreKey;\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar entry_1 = __webpack_require__(5);\n\tvar document_1 = __webpack_require__(10);\n\tvar map_1 = __webpack_require__(11);\n\tvar collection_1 = __webpack_require__(12);\n\tfunction factory(vm, entry) {\n\t    var chosenFactory = entry.source.where\n\t        ? (entry.options.map ? map_1.default : collection_1.default)\n\t        : document_1.default;\n\t    return chosenFactory(vm, entry);\n\t}\n\texports.factory = factory;\n\tfunction factoryInstance(vm) {\n\t    return function (source, options) {\n\t        return factory(vm, entry_1.getEntry(vm, source, options));\n\t    };\n\t}\n\texports.factoryInstance = factoryInstance;\n\texports.default = factory;\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar documents_1 = __webpack_require__(8);\n\tfunction factory(vm, entry) {\n\t    var source = entry.source;\n\t    var options = entry.options;\n\t    if (options.once) {\n\t        entry.promise = source.get(options.onceOptions)\n\t            .then(function (doc) {\n\t            handleDocumentUpdate(vm, entry, doc);\n\t        }).catch(options.onError);\n\t    }\n\t    else {\n\t        entry.off = source.onSnapshot(options.liveOptions, function (doc) {\n\t            handleDocumentUpdate(vm, entry, doc);\n\t        }, options.onError);\n\t    }\n\t    return entry.target;\n\t}\n\texports.factory = factory;\n\tfunction handleDocumentUpdate(vm, entry, doc) {\n\t    var options = entry.options;\n\t    if (!doc.exists) {\n\t        options.onMissing();\n\t    }\n\t    else {\n\t        entry.target = documents_1.refreshDocument(vm, entry, doc, entry.target);\n\t        if (options.reset && options.property) {\n\t            vm[options.property] = entry.target;\n\t        }\n\t        options.onSuccess(entry.target);\n\t    }\n\t}\n\texports.handleDocumentUpdate = handleDocumentUpdate;\n\texports.default = factory;\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar documents_1 = __webpack_require__(8);\n\tfunction factory(vm, entry) {\n\t    var options = entry.options;\n\t    var query = (options.query ? options.query(entry.source) : entry.source);\n\t    if (options.once) {\n\t        entry.promise = query.get(options.onceOptions)\n\t            .then(function (querySnapshot) {\n\t            var target = entry.target;\n\t            var missing = {};\n\t            for (var id in target) {\n\t                missing[id] = target[id];\n\t            }\n\t            querySnapshot.forEach(function (doc) {\n\t                var old = target[doc.id];\n\t                var updated = documents_1.refreshDocument(vm, entry, doc, old);\n\t                vm.$set(target, doc.id, updated);\n\t                delete missing[doc.id];\n\t            }, options.onError);\n\t            documents_1.destroyDocuments(vm, missing, target);\n\t            options.onSuccess(target);\n\t        }).catch(options.onError);\n\t    }\n\t    else {\n\t        entry.off = query.onSnapshot(options.liveOptions, function (querySnapshot) {\n\t            var target = entry.target;\n\t            querySnapshot.docChanges().forEach(function (change) {\n\t                var doc = change.doc;\n\t                switch (change.type) {\n\t                    case 'modified':\n\t                    case 'added':\n\t                        var old = target[doc.id];\n\t                        var updated = documents_1.refreshDocument(vm, entry, doc, old);\n\t                        vm.$set(target, doc.id, updated);\n\t                        break;\n\t                    case 'removed':\n\t                        documents_1.destroyDocument(vm, target[doc.id]);\n\t                        vm.$delete(target, doc.id);\n\t                        break;\n\t                }\n\t            }, options.onError);\n\t            options.onSuccess(target);\n\t        }, options.onError);\n\t    }\n\t    return entry.target;\n\t}\n\texports.default = factory;\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\n\tvar constants_1 = __webpack_require__(4);\n\tvar documents_1 = __webpack_require__(8);\n\tfunction factory(vm, entry) {\n\t    var options = entry.options;\n\t    var query = (options.query ? options.query(entry.source) : entry.source);\n\t    if (options.once) {\n\t        entry.promise = query.get(options.onceOptions)\n\t            .then(function (querySnapshot) {\n\t            var target = entry.target;\n\t            var missing = {};\n\t            for (var i = 0; i < target.length; i++) {\n\t                var old = target[i];\n\t                missing[old[constants_1.PROP_UID]] = old;\n\t            }\n\t            target.splice(0, target.length);\n\t            querySnapshot.forEach(function (doc) {\n\t                var old = missing[doc.id];\n\t                var updated = documents_1.refreshDocument(vm, entry, doc, old);\n\t                target.push(updated);\n\t                delete missing[updated[constants_1.PROP_UID]];\n\t            }, options.onError);\n\t            documents_1.destroyDocuments(vm, missing);\n\t            options.onSuccess(target);\n\t        }).catch(options.onError);\n\t    }\n\t    else {\n\t        entry.off = query.onSnapshot(options.liveOptions, function (querySnapshot) {\n\t            var target = entry.target;\n\t            querySnapshot.docChanges().forEach(function (change) {\n\t                var doc = change.doc;\n\t                switch (change.type) {\n\t                    case 'added':\n\t                        var created = documents_1.refreshDocument(vm, entry, doc);\n\t                        target.splice(change.newIndex, 0, created);\n\t                        break;\n\t                    case 'removed':\n\t                        target.splice(change.oldIndex, 1);\n\t                        break;\n\t                    case 'modified':\n\t                        var old = target[change.oldIndex];\n\t                        var updated = documents_1.refreshDocument(vm, entry, doc, old);\n\t                        if (change.oldIndex !== change.newIndex) {\n\t                            target.splice(change.oldIndex, 1);\n\t                            target.splice(change.newIndex, 0, updated);\n\t                        }\n\t                        else {\n\t                            target.splice(change.newIndex, 1, updated);\n\t                        }\n\t                        break;\n\t                }\n\t            }, options.onError);\n\t            options.onSuccess(target);\n\t        }, options.onError);\n\t    }\n\t    return entry.target;\n\t}\n\texports.factory = factory;\n\texports.default = factory;\n\n\n/***/ })\n/******/ ])\n});\n;\n\n\n// WEBPACK FOOTER //\n// vue-fiery.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 824a3f9ecb0408d755a6","import VueFiery from './plugin'\n\nexport default VueFiery\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts","\nimport { init, link, destroy } from './mixin'\n\n\n\nexport function install(Vue: any)\n{\n  Vue.mixin({\n    beforeCreate: init,\n    created: link,\n    beforeDestroy: destroy\n  })\n}\n\nif (typeof window !== 'undefined' && (<any>window).Vue)\n{\n  (<any>window).Vue.use(install)\n}\n\nexport default install\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugin.ts","\n\nimport { FieryVue, FieryInstance, FieryInstanceFactory, FieryTarget, FierySource, FieryOptions, FieryEntry } from './types'\nimport { getMetadata } from './util'\nimport { getEntry, closeEntry } from './entry'\nimport * as operations from './operations'\nimport { factoryInstance } from './factory'\n\n\n\nexport function init (this: FieryVue): void\n{\n  this.$fiery = factoryInstance(this) as FieryInstance\n  this.$fiery.stores = {}\n  this.$fiery.storeKeyNext = 0\n  this.$fiery.storeIdToKey = {}\n  this.$fiery.options = {}\n  this.$fiery.optionKeyNext = 0\n  this.$fiery.entry = {}\n  this.$fiery.entryList = []\n  this.$fiery.update = operations.update.bind(this)\n  this.$fiery.sync = operations.sync.bind(this)\n  this.$fiery.remove = operations.remove.bind(this)\n  this.$fiery.clear = operations.clear.bind(this)\n  this.$fiery.getChanges = operations.getChanges.bind(this)\n  this.$fiery.ref = operations.ref.bind(this)\n  this.$fiery.link = link.bind(this)\n  this.$fiery.destroy = destroy.bind(this)\n  this.$fiery.getMetadata = (data) => getMetadata(this, data)\n  this.$fires = {}\n}\n\nexport function destroy (this: FieryVue): void\n{\n  this.$fiery.stores = {}\n  this.$fiery.entry = {}\n  this.$fiery.entryList.forEach(closeEntry)\n  this.$fiery.entryList = []\n  this.$fiery = <any>(() => {}) as FieryInstance\n  this.$fires = {}\n}\n\nexport function link (this: FieryVue): void\n{\n  const entryList: (FieryEntry | null)[] = this.$fiery.entryList\n\n  for (let i = 0; i < entryList.length; i++)\n  {\n    const entry: FieryEntry | null = entryList[i]\n\n    if (entry === null)\n    {\n      continue\n    }\n\n    const options: FieryOptions = entry.options\n\n    if (!options.parent && !options.property)\n    {\n      for (let prop in this)\n      {\n        if (this[prop] === entry.target)\n        {\n          options.property = prop\n\n          this.$fiery.entry[ prop ] = entry\n          this.$fires[ prop ] = entry.source\n\n          break\n        }\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/mixin.ts","\nimport * as firebase from 'firebase'\n\n\nimport { PROP_UID, UID_SEPARATOR } from './constants'\nimport { FieryOptions, FierySource, FieryVue, FieryData, FieryMetadata } from './types'\n\n\ntype Firestore = firebase.firestore.Firestore\n\n\n\nexport function isObject (x?: any): boolean\n{\n  return Object.prototype.toString.call(x) === '[object Object]'\n}\n\nexport function isFunction (x?: any): boolean\n{\n  return typeof x === 'function'\n}\n\nexport function isArray (x?: any): boolean\n{\n  return x && x instanceof Array\n}\n\nexport function isCollectionSource (source: FierySource): boolean\n{\n  return !!((<any>source).where)\n}\n\nexport function forEach (iterable: any, callback: (item: any, key?: number | string, iterable?: any) => any): boolean\n{\n  if (isArray(iterable))\n  {\n    for (let i = 0; i < iterable.length; i++)\n    {\n      callback(iterable[i], i, iterable)\n    }\n\n    return true\n  }\n  else if (isObject(iterable))\n  {\n    for (let prop in iterable)\n    {\n      callback(iterable[prop], prop, iterable)\n    }\n\n    return true\n  }\n\n  return false\n}\n\nexport function getMetadata (vm: FieryVue, data: FieryData): FieryMetadata\n{\n  const uid: string = data[PROP_UID]\n  const [storeKey, optionKey, path] = uid.split(UID_SEPARATOR) as string[]\n  const store: Firestore = vm.$fiery.stores[parseInt(storeKey)]\n  const options: FieryOptions = vm.$fiery.options[parseInt(optionKey)]\n\n  return { uid, path, storeKey, store, optionKey, options }\n}\n\nexport function createRecord (data: FieryData, options: FieryOptions): FieryData\n{\n  if (options.record)\n  {\n    let recordOptions = options.recordOptions\n    let recordFunctions = options.recordFunctions\n\n    if (recordOptions.sync) data[recordOptions.sync] = recordFunctions.sync\n    if (recordOptions.update) data[recordOptions.update] = recordFunctions.update\n    if (recordOptions.remove) data[recordOptions.remove] = recordFunctions.remove\n    if (recordOptions.clear) data[recordOptions.clear] = recordFunctions.clear\n    if (recordOptions.getChanges) data[recordOptions.getChanges] = recordFunctions.getChanges\n    if (recordOptions.ref) data[recordOptions.ref] = recordFunctions.ref\n  }\n\n  return data\n}\n\nexport function isEqual(a: any, b: any): boolean\n{\n  if (a === b)\n  {\n    return true\n  }\n\n  if (!a || !b)\n  {\n    return false\n  }\n\n  if (isArray(a) && isArray(b))\n  {\n    if (a.length !== b.length)\n    {\n      return false\n    }\n\n    for (let i = 0; i < a.length; i++)\n    {\n      if (!isEqual(a[i], b[i]))\n      {\n        return false\n      }\n    }\n\n    return true\n  }\n\n  if (isObject(a) && isObject(b))\n  {\n    for (let prop in a)\n    {\n      if (!isEqual(a[prop], b[prop]))\n      {\n        return false\n      }\n    }\n\n    for (let prop in b)\n    {\n      if (!(prop in a))\n      {\n        return false\n      }\n    }\n\n    return true\n  }\n\n  return false\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util.ts","\nexport const PROP_VALUE = '.value'\nexport const PROP_UID = '.uid'\nexport const UID_SEPARATOR = '///'\nexport const ENTRY_SEPARATOR = '/'\nexport const STORE_SEPARATOR = '/'\nexport const RECORD_OPTIONS = {\n  sync: '$sync',\n  update: '$update',\n  remove: '$remove',\n  ref: '$ref',\n  clear: '$clear',\n  getChanges: '$getChanges'\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/constants.ts","\n\nimport { isCollectionSource } from './util'\nimport { getOptions } from './options'\nimport { FieryOptions, FieryInstance, FieryTarget, FieryEntry, FierySources, FieryVue, FierySource } from './types'\n\n\nexport function closeEntry (entry: FieryEntry): void\n{\n  if (entry && entry.off)\n  {\n    entry.off()\n\n    delete entry.off\n  }\n}\n\nexport function getEntry (vm: FieryVue, source: FierySource, optionsInput?: Partial<FieryOptions>, entryKeyInput?: string, useRawOptions: boolean = false)\n{\n  const options: FieryOptions = useRawOptions\n    ? optionsInput as FieryOptions\n    : getOptions(vm, optionsInput, source)\n  const target: FieryTarget = isCollectionSource(source)\n    ? options.newCollection()\n    : options.newDocument()\n  const property: string | undefined = options.property\n  const entryKey: string = entryKeyInput || property || ''\n  const fiery: FieryInstance = vm.$fiery\n  const fires: FierySources = vm.$fires\n\n  let existing: FieryEntry | undefined = fiery.entry[ entryKey ]\n  let children = {}\n  let entry: FieryEntry = { source, options, target, children }\n\n  if (existing)\n  {\n    closeEntry(existing)\n\n    entry.target = existing.target\n  }\n\n  if (!entryKey || !(entryKey in fiery.entry))\n  {\n    entry.index = fiery.entryList.length\n\n    fiery.entryList.push(entry)\n  }\n\n  if (entryKey)\n  {\n    fiery.entry[ entryKey ] = entry\n  }\n\n  if (property)\n  {\n    fires[ property ] = source\n  }\n\n  return entry\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/entry.ts","\n\n\nimport { PROP_UID, PROP_VALUE, RECORD_OPTIONS } from './constants'\nimport { FieryOptions, FieryInstance, FieryVue, FieryExclusions, FierySource, FieryData, FieryMap, FieryChangesCallback, FieryEquality } from './types'\nimport { isObject, isFunction, isArray } from './util'\nimport * as operations from './operations'\n\n\n\nexport function getOptions (vm: FieryVue, options?: Partial<FieryOptions>, source?: FierySource): FieryOptions\n{\n  if (!options || !isObject(options))\n  {\n    options = {}\n  }\n\n  if (!isFunction(options.onError))\n  {\n    options.onError = (message) => {}\n  }\n\n  if (!isFunction(options.onMissing))\n  {\n    options.onMissing = () => {}\n  }\n\n  if (!isFunction(options.onSuccess))\n  {\n    options.onSuccess = (results) => {}\n  }\n\n  if (!isFunction(options.onRemove))\n  {\n    options.onRemove = () => {}\n  }\n\n  if (!options.liveOptions)\n  {\n    options.liveOptions = {}\n  }\n\n  if (!options.propValue)\n  {\n    options.propValue = PROP_VALUE\n  }\n\n  if (!options.recordOptions)\n  {\n    options.recordOptions = RECORD_OPTIONS\n  }\n\n  if (options.record)\n  {\n    options.recordFunctions = {\n      sync: function(this: FieryData, fields?: string[]) {\n        return operations.sync.call(vm, this, fields)\n      },\n      update: function(this: FieryData, fields?: string[]) {\n        return operations.update.call(vm, this, fields)\n      },\n      remove: function(this: FieryData, excludeSubs: boolean = false) {\n        return operations.remove.call(vm, this, excludeSubs)\n      },\n      ref: function(this: FieryData, sub?: string) {\n        return operations.ref.call(vm, this, sub)\n      },\n      clear: function(this: FieryData, props: string | string[]) {\n        return operations.clear.call(vm, this, props)\n      },\n      getChanges: function(this: FieryData,\n        fieldsOrCallback: string[] | FieryChangesCallback,\n        callbackOrEquality?: FieryChangesCallback | FieryEquality,\n        equalityOrNothing?: FieryEquality) {\n        return operations.getChanges.call(vm, this, fieldsOrCallback, callbackOrEquality, equalityOrNothing)\n      }\n    }\n  }\n\n  if (options.type)\n  {\n    let typeConstructor = options.type\n\n    options.newDocument = (encoded?: FieryData) => (new typeConstructor() as FieryData)\n  }\n  else if (!options.newDocument)\n  {\n    options.newDocument = (encoded?: FieryData) => ({} as FieryData)\n  }\n\n  if (!options.newCollection)\n  {\n    options.newCollection = options.map\n      ? () => ({} as FieryMap)\n      : () => ([] as FieryData[])\n  }\n\n  if (!options.exclude)\n  {\n    options.exclude = {}\n\n    if (options.key)\n    {\n      options.exclude[options.key] = true\n    }\n  }\n  else if (isArray(options.exclude))\n  {\n    let excludeArray = options.exclude as string[]\n\n    options.exclude = {}\n\n    for (let i = 0; i < excludeArray.length; i++)\n    {\n      options.exclude[excludeArray[i]] = true\n    }\n  }\n\n  let excludeMap: FieryExclusions = options.exclude as FieryExclusions\n\n  excludeMap[options.propValue] = true\n  excludeMap[PROP_UID] = true\n\n  for (let recordOperation in options.recordOptions)\n  {\n    excludeMap[options.recordOptions[recordOperation]] = true\n  }\n\n  if (options.sub)\n  {\n    for (let subProp in options.sub)\n    {\n      let subOptions = getOptions(vm, options.sub[subProp] as Partial<FieryOptions>)\n\n      subOptions.property = subProp\n      subOptions.parent = options as FieryOptions\n\n      options.sub[subProp] = subOptions\n      excludeMap[subProp] = true\n    }\n  }\n\n  if (!options.id)\n  {\n    const fiery: FieryInstance = vm.$fiery\n\n    options.id = ++fiery.optionKeyNext\n\n    fiery.options[options.id] = options as FieryOptions\n  }\n\n  return options as FieryOptions\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/options.ts","\nimport { FieryVue, FieryOptions, FieryEntry, FieryData, FierySource, FieryChangesCallback, FieryEquality } from './types'\nimport { parseDocument } from './documents'\nimport { getMetadata, forEach, isEqual } from './util'\n\n\n\nexport function update (this: FieryVue, data: FieryData, fields?: string[]): Promise<void> | undefined\n{\n  const { store, path, options } = getMetadata(this, data)\n\n  if (store && path)\n  {\n    const values: FieryData = getValues(data, options, fields)\n\n    return store.doc(path).update(values)\n  }\n}\n\nexport function sync (this: FieryVue, data: FieryData, fields?: string[]): Promise<void> | undefined\n{\n  const { store, path, options } = getMetadata(this, data)\n\n  if (store && path)\n  {\n    const values = getValues(data, options, fields)\n\n    return store.doc(path).set(values)\n  }\n}\n\nexport function remove(this: FieryVue, data: FieryData, excludeSubs: boolean = false): Promise<void> | undefined\n{\n  const { store, path, options } = getMetadata(this, data)\n\n  if (store && path)\n  {\n    if (!excludeSubs && options.sub)\n    {\n      for (let subProp in options.sub)\n      {\n        forEach(data[subProp], (sub) =>\n        {\n          this.remove(sub as FieryData)\n        })\n      }\n    }\n\n    return store.doc(path).delete()\n  }\n}\n\nexport function clear (this: FieryVue, data: FieryData, props: string | string[]): Promise<void> | undefined\n{\n  const { store, path, options } = getMetadata(this, data)\n  const propsArray: string[] = props instanceof Array ? props : [props]\n\n  if (store && path)\n  {\n    const doc = store.doc(path)\n    const deleting: any = {}\n    let deleteCount: number = 0\n\n    for (let prop of propsArray)\n    {\n      if (options.sub && prop in options.sub && data[prop])\n      {\n        forEach(data[prop], (sub) =>\n        {\n          this.remove(sub as FieryData)\n        })\n      }\n      else if (prop in data)\n      {\n        let firebaseRuntime: any = (<any>store.app).firebase_\n\n        if (firebaseRuntime)\n        {\n          deleting[prop] = firebaseRuntime.firestore.FieldValue.delete()\n          deleteCount++\n        }\n      }\n    }\n\n    if (deleteCount > 0)\n    {\n      return doc.update(deleting)\n    }\n  }\n}\n\nexport function getChanges (this: FieryVue, data: FieryData,\n  fieldsOrCallback: string[] | FieryChangesCallback,\n  callbackOrEquality?: FieryChangesCallback | FieryEquality,\n  equalityOrNothing?: FieryEquality): Promise<void> | undefined\n{\n  const { store, path, options } = getMetadata(this, data)\n  const fields: string[] | undefined = typeof fieldsOrCallback === 'string' ? fieldsOrCallback as string[] : undefined\n  const callback: FieryChangesCallback = (fields ? callbackOrEquality : fieldsOrCallback) as FieryChangesCallback\n  const equality: FieryEquality = ((fields ? equalityOrNothing : callbackOrEquality) || isEqual) as FieryEquality\n\n  if (store && path)\n  {\n    const current: FieryData = getValues(data, options, fields)\n\n    return store.doc(path).get().then((doc) =>\n    {\n      const encoded: FieryData = parseDocument(doc, options)\n      const updated: FieryData = {}\n      const old: FieryData = {}\n      let changes = false\n\n      for (let prop in current)\n      {\n        let valueUpdated = encoded[prop]\n        let valueOld = current[prop]\n\n        if (!equality(valueOld, valueUpdated))\n        {\n          changes = true\n          updated[prop] = valueUpdated\n          old[prop] = valueOld\n        }\n      }\n\n      callback(changes, updated, old)\n    })\n  }\n}\n\nexport function ref (this: FieryVue, data: FieryData, sub?: string): FierySource | undefined\n{\n  const { store, path } = getMetadata(this, data)\n\n  if (store && path)\n  {\n    let doc = store.doc(path)\n\n    return sub ? doc.collection(sub) : doc\n  }\n}\n\nexport function getValues (data: FieryData, options: FieryOptions, fields?: string[]): FieryData\n{\n  const explicit: string[] = fields || options.include\n  const values: FieryData = {}\n\n  if (explicit)\n  {\n    for (let i = 0; i < explicit.length; i++)\n    {\n      let prop: string = explicit[i]\n\n      if (prop in data)\n      {\n        values[prop] = data[prop]\n      }\n    }\n  }\n  else\n  {\n    for (let prop in data)\n    {\n      if (!(prop in options.exclude))\n      {\n        values[prop] = data[prop]\n      }\n    }\n  }\n\n  if (options.encoders)\n  {\n    for (let prop in options.encoders)\n    {\n      if (prop in values)\n      {\n        values[prop] = options.encoders[prop](values[prop], data)\n      }\n    }\n  }\n\n  return values\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/operations.ts","\nimport * as firebase from 'firebase'\n\n\n\nimport { PROP_UID, UID_SEPARATOR, STORE_SEPARATOR, ENTRY_SEPARATOR } from './constants'\nimport { FieryOptions, FieryInstance, FieryEntry, FieryData, FieryMap, FieryVue } from './types'\nimport { isObject, forEach, getMetadata, createRecord } from './util'\nimport { closeEntry, getEntry } from './entry'\nimport { factory } from './factory'\n\n\n\ntype DocumentSnapshot = firebase.firestore.DocumentSnapshot\ntype Firestore = firebase.firestore.Firestore\n\n\n\nexport function decodeDocument(encoded: FieryData, options: FieryOptions): FieryData\n{\n  if (options.decode)\n  {\n    encoded = options.decode(encoded)\n  }\n  else if (options.decoders)\n  {\n    for (let prop in options.decoders)\n    {\n      if (prop in encoded)\n      {\n        encoded[prop] = options.decoders[prop](encoded[prop], encoded)\n      }\n    }\n  }\n\n  return encoded\n}\n\nexport function parseDocument (doc: DocumentSnapshot, options: FieryOptions): FieryData\n{\n  let value = doc.data()\n  let out = (isObject(value) ? value : { [options.propValue]: value }) as FieryData\n\n  if (out && options.key)\n  {\n    out[options.key] = doc.id\n  }\n\n  return out\n}\n\nexport function refreshDocument (vm: FieryVue, entry: FieryEntry, doc: DocumentSnapshot, data?: FieryData): FieryData\n{\n  const options: FieryOptions = entry.options\n  const property: string | undefined = options.property\n  const replace: boolean = !!(options.reset && property)\n  const encoded: FieryData = parseDocument(doc, options)\n  const decoded: FieryData = decodeDocument(encoded, options)\n\n  if (!data)\n  {\n    const identifier: string = getDocumentIdentifier(vm, options, doc)\n\n    data = options.newDocument(decoded)\n    data[PROP_UID] = identifier\n\n    copyData(vm, data, decoded)\n    createRecord(data, options)\n\n    if (options.sub)\n    {\n      for (let subProp in options.sub)\n      {\n        let subOptions: FieryOptions = options.sub[subProp]\n        let subEntryKey: string = doc.ref.path + ENTRY_SEPARATOR + subProp\n        let subEntry: FieryEntry = getEntry(vm, doc.ref.collection(subProp), subOptions, subEntryKey, true)\n\n        data[subProp] = factory(vm, subEntry)\n      }\n    }\n  }\n  else if (replace)\n  {\n    const replaced: FieryData = options.newDocument(decoded)\n\n    if (options.sub)\n    {\n      for (let subProp in options.sub)\n      {\n        if (data[subProp])\n        {\n          replaced[subProp] = data[subProp]\n        }\n      }\n    }\n\n    createRecord(replaced, options)\n\n    data = copyData(vm, replaced, decoded)\n  }\n  else\n  {\n    copyData(vm, data, decoded)\n  }\n\n  return data\n}\n\nexport function copyData (vm: FieryVue, data: FieryData, update: FieryData): FieryData\n{\n  for (let prop in update)\n  {\n    vm.$set(data, prop, update[prop])\n  }\n\n  return data\n}\n\nexport function destroyDocuments (vm: FieryVue, map: FieryMap, fromObject?: FieryMap): void\n{\n  for (let id in map)\n  {\n    const old: FieryData = map[id]\n\n    destroyDocument(vm, old)\n\n    if (fromObject)\n    {\n      vm.$delete(fromObject, id)\n    }\n  }\n}\n\nexport function destroyDocument (vm: FieryVue, data: FieryData): void\n{\n  let { path, options } = getMetadata(vm, data)\n\n  if (options.sub)\n  {\n    const fiery: FieryInstance = vm.$fiery\n\n    for (let subProp in options.sub)\n    {\n      let subEntryKey: string = path + ENTRY_SEPARATOR + subProp\n      let subEntry: FieryEntry = fiery.entry[ subEntryKey ]\n\n      if (subEntry)\n      {\n        closeEntry(subEntry)\n\n        delete fiery.entry[ subEntryKey ]\n\n        if (typeof subEntry.index === 'number')\n        {\n          fiery.entryList[subEntry.index] = null\n\n          delete subEntry.index\n        }\n      }\n\n      forEach(data[subProp], (value) =>\n      {\n        destroyDocument(vm, value)\n      })\n    }\n  }\n}\n\nexport function getDocumentIdentifier (vm: FieryVue, options: FieryOptions, doc: DocumentSnapshot)\n{\n  return getStoreKey(vm, doc) +\n    UID_SEPARATOR +\n    options.id +\n    UID_SEPARATOR +\n    doc.ref.path\n}\n\nexport function getStoreKey (vm: FieryVue, doc: DocumentSnapshot): number\n{\n  const firestore = (<any>doc)._firestore\n  const db = firestore._databaseId\n  const id: string = db.database + STORE_SEPARATOR + db.projectId\n\n  const fiery: FieryInstance = vm.$fiery\n  let key: number = fiery.storeIdToKey[id]\n\n  if (!key)\n  {\n    key = ++fiery.storeKeyNext\n    fiery.stores[key] = firestore\n    fiery.storeIdToKey[id] = key\n  }\n\n  return key\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/documents.ts","\n\nimport { FieryVue, FieryEntry, FieryTarget, FierySource, FieryInstanceFactory, FieryOptions } from '../types'\nimport { getEntry } from '../entry'\n\n\n\nimport factoryDocument from './document'\nimport factoryMap from './map'\nimport factoryCollection from './collection'\n\n\n\nexport function factory (vm: FieryVue, entry: FieryEntry): FieryTarget\n{\n  let chosenFactory = (<any>entry.source).where\n    ? (entry.options.map ? factoryMap : factoryCollection)\n    : factoryDocument\n\n  return chosenFactory(vm, entry)\n}\n\nexport function factoryInstance (vm: FieryVue): FieryInstanceFactory\n{\n  return (source: FierySource, options?: Partial<FieryOptions>): FieryTarget => {\n    return factory(vm, getEntry(vm, source, options))\n  }\n}\n\nexport default factory\n\n\n\n// WEBPACK FOOTER //\n// ./src/factory/index.ts","\nimport * as firebase from 'firebase'\n\n\nimport { FieryOptions, FieryEntry, FieryData, FieryVue } from '../types'\nimport { refreshDocument } from '../documents'\n\n\n\ntype DocumentSnapshot = firebase.firestore.DocumentSnapshot\ntype DocumentChange = firebase.firestore.DocumentChange\ntype DocumentReference = firebase.firestore.DocumentReference\ntype DocumentListenOptions = firebase.firestore.DocumentListenOptions\n\n\n\nexport function factory (vm: FieryVue, entry: FieryEntry): FieryData\n{\n  const source: DocumentReference = entry.source as DocumentReference\n  const options: FieryOptions = entry.options\n\n  if (options.once)\n  {\n    entry.promise = source.get(options.onceOptions)\n      .then((doc: DocumentSnapshot) =>\n      {\n        handleDocumentUpdate(vm, entry, doc)\n\n      }).catch(options.onError)\n  }\n  else\n  {\n    entry.off = source.onSnapshot(options.liveOptions as DocumentListenOptions,\n      (doc: DocumentSnapshot) =>\n      {\n        handleDocumentUpdate(vm, entry, doc)\n\n      }, options.onError)\n  }\n\n  return entry.target as FieryData\n}\n\nexport function handleDocumentUpdate (vm: FieryVue, entry: FieryEntry, doc: DocumentSnapshot): void\n{\n  const options: FieryOptions = entry.options\n\n  if (!doc.exists)\n  {\n    options.onMissing()\n  }\n  else\n  {\n    entry.target = refreshDocument(vm, entry, doc, entry.target)\n\n    if (options.reset && options.property)\n    {\n      vm[options.property] = entry.target\n    }\n\n    options.onSuccess(entry.target)\n  }\n}\n\nexport default factory\n\n\n\n// WEBPACK FOOTER //\n// ./src/factory/document.ts","\nimport * as firebase from 'firebase'\n\n\n\nimport { PROP_UID } from '../constants'\nimport { FieryVue, FieryEntry, FieryTarget, FieryData, FieryOptions, FieryMap } from '../types'\nimport { refreshDocument, destroyDocuments, destroyDocument } from '../documents'\n\n\n\ntype Query = firebase.firestore.Query\ntype QuerySnapshot = firebase.firestore.QuerySnapshot\ntype DocumentSnapshot = firebase.firestore.DocumentSnapshot\ntype DocumentChange = firebase.firestore.DocumentChange\ntype CollectionReference = firebase.firestore.CollectionReference\ntype QueryListenOptions = firebase.firestore.QueryListenOptions\n\n\n\nfunction factory (vm: FieryVue, entry: FieryEntry): FieryMap\n{\n  type CollectionQuery = CollectionReference | Query\n  const options: FieryOptions = entry.options\n  const query: CollectionQuery = (options.query ? options.query(entry.source) : entry.source) as CollectionQuery\n\n  if (options.once)\n  {\n    entry.promise = query.get(options.onceOptions)\n      .then((querySnapshot: QuerySnapshot) =>\n      {\n        const target: FieryMap = entry.target as FieryMap\n\n        let missing: FieryMap = {}\n        for (let id in target) {\n          missing[id] = target[id]\n        }\n\n        querySnapshot.forEach((doc: DocumentSnapshot) =>\n        {\n          const old: FieryData = target[doc.id]\n          const updated: FieryData = refreshDocument(vm, entry, doc, old)\n\n          vm.$set(target, doc.id, updated)\n          delete missing[doc.id]\n\n        }, options.onError)\n\n        destroyDocuments(vm, missing, target)\n\n        options.onSuccess(target)\n\n      }).catch(options.onError)\n  }\n  else\n  {\n    entry.off = query.onSnapshot(options.liveOptions as QueryListenOptions,\n      (querySnapshot: QuerySnapshot) =>\n      {\n        const target: FieryMap = entry.target as FieryMap\n\n        (<any>querySnapshot).docChanges().forEach((change: DocumentChange) =>\n        {\n          const doc: DocumentSnapshot = change.doc\n\n          switch (change.type) {\n            case 'modified':\n            case 'added':\n              const old: FieryData = target[doc.id]\n              const updated: FieryData = refreshDocument(vm, entry, doc, old)\n              vm.$set(target, doc.id, updated)\n              break\n            case 'removed':\n              destroyDocument(vm, target[doc.id])\n              vm.$delete(target, doc.id)\n              break\n          }\n        }, options.onError)\n\n        options.onSuccess(target)\n\n      }, options.onError)\n  }\n\n  return entry.target as FieryMap\n}\n\nexport default factory\n\n\n\n// WEBPACK FOOTER //\n// ./src/factory/map.ts","\nimport * as firebase from 'firebase'\n\n\nimport { PROP_UID } from '../constants'\nimport { FieryVue, FieryEntry, FieryTarget, FieryData, FieryOptions, FieryMap } from '../types'\nimport { refreshDocument, destroyDocuments } from '../documents'\n\n\n\ntype Query = firebase.firestore.Query\ntype QuerySnapshot = firebase.firestore.QuerySnapshot\ntype DocumentSnapshot = firebase.firestore.DocumentSnapshot\ntype DocumentChange = firebase.firestore.DocumentChange\ntype CollectionReference = firebase.firestore.CollectionReference\ntype QueryListenOptions = firebase.firestore.QueryListenOptions\n\n\n\nexport function factory (vm: FieryVue, entry: FieryEntry): FieryData[]\n{\n  type CollectionQuery = CollectionReference | Query\n  const options: FieryOptions = entry.options\n  const query: CollectionQuery = (options.query ? options.query(entry.source) : entry.source) as CollectionQuery\n\n  if (options.once)\n  {\n    entry.promise = query.get(options.onceOptions)\n      .then((querySnapshot: QuerySnapshot) =>\n      {\n        const target: FieryData[] = entry.target as FieryData[]\n\n        const missing: FieryMap = {}\n\n        for (let i = 0; i < target.length; i++)\n        {\n          const old: FieryData = target[i]\n          missing[old[PROP_UID]] = old\n        }\n\n        target.splice(0, target.length);\n\n        querySnapshot.forEach((doc: DocumentSnapshot) =>\n        {\n          const old = missing[doc.id]\n          const updated = refreshDocument(vm, entry, doc, old)\n\n          target.push(updated)\n          delete missing[updated[PROP_UID]]\n\n        }, options.onError)\n\n        destroyDocuments(vm, missing)\n\n        options.onSuccess(target)\n\n      }).catch(options.onError)\n  }\n  else\n  {\n    entry.off = query.onSnapshot(options.liveOptions as QueryListenOptions,\n      (querySnapshot: QuerySnapshot) =>\n      {\n        const target: FieryData[] = entry.target as FieryData[]\n\n        (<any>querySnapshot).docChanges().forEach((change: DocumentChange) =>\n        {\n          const doc: DocumentSnapshot = change.doc\n\n          switch (change.type) {\n            case 'added':\n              const created: FieryData = refreshDocument(vm, entry, doc)\n              target.splice(change.newIndex, 0, created)\n              break\n            case 'removed':\n              target.splice(change.oldIndex, 1)\n              break\n            case 'modified':\n              const old: FieryData = target[change.oldIndex]\n              const updated: FieryData = refreshDocument(vm, entry, doc, old)\n\n              if (change.oldIndex !== change.newIndex) {\n                target.splice(change.oldIndex, 1)\n                target.splice(change.newIndex, 0, updated)\n              } else {\n                target.splice(change.newIndex, 1, updated)\n              }\n              break\n          }\n        }, options.onError)\n\n        options.onSuccess(target)\n\n      }, options.onError)\n  }\n\n  return entry.target as FieryData[]\n}\n\nexport default factory\n\n\n\n// WEBPACK FOOTER //\n// ./src/factory/collection.ts"],"sourceRoot":""}